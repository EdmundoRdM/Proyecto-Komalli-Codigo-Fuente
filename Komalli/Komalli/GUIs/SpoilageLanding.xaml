<Page x:Class="Komalli.GUIs.SpoilageLanding"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Komalli.GUIs"
      mc:Ignorable="d" 
      d:DesignHeight="922.16" d:DesignWidth="1742.8"
      Title="SpoilageLanding">


    <Page.Resources>
        <DataTemplate x:Key="SpoilageTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition Width="650" />
                    <ColumnDefinition Width="300" />
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="100" />
                </Grid.ColumnDefinitions>

                <Label Content="{Binding SpoilageId}" 
                    Grid.Column="0" 
                    FontSize="20" 
                    VerticalAlignment="Center" />

                <Label Content="{Binding SpoilageConcept}" 
                       Grid.Column="1" 
                       FontSize="20" 
                       VerticalAlignment="Center" />

                <Label Content="{Binding Date, StringFormat='dd/MM/yyyy HH:mm'}" 
                       Grid.Column="2" 
                       FontSize="20" 
                       VerticalAlignment="Center" />

                <Label Content="{Binding Total, StringFormat='C'}" 
                       Grid.Column="3" 
                       FontSize="20" 
                       VerticalAlignment="Center" />

                <Button Content="Ver Detalles"
                        x:Name="btnViewSpoilageDetails"
                        Click="btnViewSpoilageDetails_Click"
                        Grid.Column="4" 
                        FontSize="20" 
                        Tag="{Binding}" />
            </Grid>
        </DataTemplate>
        <Style TargetType="{x:Type DataGridColumnHeader}">
            <Setter Property="Background" Value="#1f6700"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Height" Value="50"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="25"/>
        </Style>



    </Page.Resources>


    <Grid x:Name="SpoilageLandingBackground" Background="White">
        <Grid x:Name="DefaultBackground" 
            Background="white" Visibility="Hidden">
            <Image
                 HorizontalAlignment="Left"
                 Height="525" 
                 Margin="719,189,0,0" 
                 VerticalAlignment="Top"
                 Width="613" 
                 Source="{StaticResource ComedoresU}"/>
        </Grid>

        <Grid x:Name="SpoilageForm" Visibility="Visible"
            Background="White">

            <Rectangle Fill="#2C9B00"
                    HorizontalAlignment="Left" 
                    Height="100" 
                    Width="1442"
                    Margin="301,53,0,0" 
                    Stroke="Black" 
                    VerticalAlignment="Top"/>

            <Image Source="\Media\ComedoresUVCircular.png"
                    HorizontalAlignment="Left" 
                    Height="200" 
                    Width="200"
                    Margin="408,5,0,0" 
                    VerticalAlignment="Top" />

            <Border x:Name="SpoilageContainer" Margin="350,353,46,52" 
                BorderBrush="Gray" 
                BorderThickness="1" 
                CornerRadius="10" 
                Background="White"
                Visibility="Visible">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Border x:Name="SpoilageList" Background="#005BAA" Grid.Row="0">
                        <Grid Margin="0,-2,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="550" />
                                <ColumnDefinition Width="300" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="100" />
                            </Grid.ColumnDefinitions>

                            <Label Content="No. Merma" 
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       FontSize="20"
                       Grid.Column="0" />
                            <Label Content="Concepto de merma" 
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       FontSize="20"
                       Grid.Column="1" />
                            <Label Content="Hora y fecha de merma" 
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       FontSize="20"
                       Grid.Column="2" />
                            <Label Content="Total" 
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       FontSize="20"
                       Grid.Column="3" />
                            <Label Content="Info" 
                       FontWeight="Bold"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       FontSize="20"
                       Grid.Column="4" />
                        </Grid>
                    </Border>

                    <Border x:Name="SpoilageListNames" Grid.Row="1"
                        Background="White">
                        <ListBox ItemTemplate="{StaticResource SpoilageTemplate}"
                     x:Name="SpoilageListBox"
                     ItemsSource="{Binding WasteItems}" 
                     SelectionMode="Single"/>
                    </Border>
                </Grid>

            </Border>

            <Grid Margin="351,297,45,51"
                  Background="Gray"
                  Visibility="Hidden"
                  x:Name="SpoilageDetailsBackground">
                <TextBox HorizontalAlignment="Left" 
                         Margin="44,169,0,0" 
                         TextWrapping="Wrap" 
                         Text="" 
                         VerticalAlignment="Top" 
                         Width="436" Height="48"
                         x:Name="SpoilageNumber"/>

                <Label Content="Numero de Merma:" 
                       FontSize="30"
                       FontWeight="Bold"
                       HorizontalAlignment="Left" 
                       Margin="44,114,0,0" 
                       VerticalAlignment="Top" 
                       Width="316"/>


                <TextBox HorizontalAlignment="Left" 
                         Margin="40,286,0,0" 
                         TextWrapping="Wrap" 
                         Text="" 
                         VerticalAlignment="Top" 
                         Width="440" Height="161"
                         x:Name="SpoilageConcept"/>

                <Label Content="Cencepto de merma:"
                       FontSize="30"
                       FontWeight="Bold"
                       HorizontalAlignment="Left" 
                       Margin="46,215,0,0" 
                       VerticalAlignment="Top" 
                       Width="152"/>


                <DataGrid x:Name="OrderDetailDataGrid" 
                      AutoGenerateColumns="False" 
                      CanUserAddRows="False" 
                      CanUserResizeColumns="False"
                      CanUserSortColumns="False"
                      Margin="524,64,35,184"
                      IsReadOnly="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Producto" 
                            Binding="{Binding ProductName}" 
                            Width="320"/>
                        <DataGridTemplateColumn Header="Cantidad" Width="*">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Content="+" 
                                                FontSize="20" 
                                                Width="30" 
                                                Height="30" 
                                                Margin="0,0,5,0"
                                                Click="IncreaseQuantity_Click"
                                                Tag="{Binding}">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Page}, Path=IsEditing}" Value="True">
                                                            <Setter Property="IsEnabled" Value="True"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                        <Label Content="{Binding Quantity}" 
                                               FontSize="20" 
                                               Width="40" 
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               HorizontalContentAlignment="Center" />
                                        <Button Content="-" 
                                                FontSize="20" 
                                                Width="30" 
                                                Height="30"
                                                Margin="5,0,0,0"
                                                Click="DecreaseQuantity_Click"
                                                Tag="{Binding}">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=Page}, Path=IsEditing}" Value="True">
                                                            <Setter Property="IsEnabled" Value="True"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTextColumn Header="Precio" 
                            Binding="{Binding UnitPrice}" 
                            Width="*"/>
                        <DataGridTextColumn Header="Precio total" 
                            Binding="{Binding Total}" 
                            Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>

                <Label Content="Precio total"
                    FontSize="30"
                    FontWeight="Bold"
                    HorizontalAlignment="Left" 
                    Margin="956,401,0,0" 
                    VerticalAlignment="Top"
                    x:Name="lblTotalPrice"
                    Width="350"/>

                <Button Content="Regresar"
                        x:Name="btnBackToSpoilageList"
                        HorizontalAlignment="Left" 
                        Margin="215,500,0,0" 
                        VerticalAlignment="Top" 
                        Height="50" Width="296"
                        Foreground="White" 
                        Background="#FF31318C"
                        Cursor="Hand"
                        FontFamily="Inter" 
                        FontSize="30"
                        Click="btnBackToSpoilageList_Click"/>

                <Button Content="Editar" 
                        x:Name="btnEdit"
                        HorizontalAlignment="Left" 
                        Margin="568,500,0,0" 
                        VerticalAlignment="Top" 
                        Height="50" Width="296"
                        Foreground="White" 
                        Background="Orange"
                        Cursor="Hand"
                        FontFamily="Inter" 
                        FontSize="30"
                        Click="btnEdit_Click"/>

                <Button Content="Guardar cambios" 
                        HorizontalAlignment="Left" 
                        Margin="930,500,0,0" 
                        VerticalAlignment="Top" 
                        Height="50" Width="296"
                        Foreground="White" 
                        Background="#2C9B00"
                        Cursor="Hand"
                        FontFamily="Inter" 
                        FontSize="30"
                        Visibility="Hidden"
                        x:Name="btnSaveChanges"
                        Click="btnSaveChanges_Click"/>

            </Grid>

        </Grid>

        <local:NavigationBar HorizontalAlignment="Left" Width="300"/>
    </Grid>

</Page>
